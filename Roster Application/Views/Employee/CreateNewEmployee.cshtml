@model ListsModel


<div class="text-primary p-1">

    <h1 class="display-4 text-center mb-5">Create A New Employee</h1>
    <partial name="_Notifications" />

</div>
<div class="form-group row p-1" style="font-size:x-large">
    <div class="mb-0 row p-3">
        <label class="p-0" style="font-size:x-large">Name:</label>
        <input class="col-sm-5 p-3" style="font-size:large" id="EmployeeName">
    </div>
    <div class="mb-0 row p-3">
        <label class="p-0" style="font-size:x-large">Surname:</label>
        <input class="col-sm-5 p-3" style="font-size:large" id="EmployeeSurname">
    </div>
    <div class="mb-0 row p-3">
        <label class="p-0" style="font-size:x-large">Address:</label>
        <input class="col-sm-5 p-3" style="font-size:large" id="EmployeeAddress">
    </div>
    <div class="mb-0 row p-3">
        <label class="p-0" style="font-size:x-large">Contact Number:</label>
        <input class="col-sm-5 p-3" style="font-size:large" id="EmployeeContactNumber">
    </div>
    <div class="mb-0 row p-3">
        <label class="p-0" style="font-size:x-large">Email Address:</label>
        <input class="col-sm-5 p-3" style="font-size:large" id="EmployeeEmail">
    </div>
    <div class="mb-0 row p-3">
        <label class="p-0" style="font-size:x-large">Category</label>
        <select class="form-select-sm p-3 col-sm-5" style="font-size:large" name="Category" id="SelectCategory">
            <option value="" disabled selected id="Category">Choose a Category</option> @*This will serve as a placeholder in the dropdown list*@

            @if(Model.CategoryList!=null)
            {
                @foreach (var item in @Model.CategoryList)
                {
                    if (item.CategoryName != "")
                    {
                        <option>@item.CategoryName</option>
                    }
                }
            }

        </select>
    </div>
    
    <div class="container">
        <div class="row">
            <div class="col-md-1 p-3">
                <button class="btn btn-primary btn-lg p-3" id="Save">Save</button>
            </div>

            <div class="col-md-1 p-3">
                <form method="post" action="/Employee/EmployeeOptions">
                    <button type="submit" class="btn btn-lg btn-primary p-3" id="back">Back</button>
                </form>
            </div>
        </div>
    </div>
</div>
@section Scripts
{
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#Save").on("click", function () {
                var name = $("#EmployeeName").val();
                var surname = $("#EmployeeSurname").val();
                var address = $("#EmployeeAddress").val();
                var contactNumber = $("#EmployeeContactNumber").val();
                var emailAddress = $("#EmployeeEmail").val();
                var category = $("#SelectCategory").val();

                var message = "The folowing errors where encountered:\n\n";
                var employeeData = [name, surname, address, contactNumber, emailAddress, category];
                var ids = [$("#EmployeeName"), $("#EmployeeSurname"), $("#EmployeeAddress"), $("#EmployeeContactNumber"), $("#EmployeeEmail"), $("#SelectCategory")];
                var elementsNames = ["Name", "Surname", "Address", "Contact Number", "Email Address", "Category"];

                $.ajax({
                    url: "/Employee/SCheckDataPriorSaving",
                    type: "POST",
                    data: { empData: employeeData },
                    success: function (data) {
                        if(data[6]!="0")
                        {
                            data.pop();//Remove the last element from data, as it shouldn't be included in the for each loop below.
                            $.each(data, function (index, element) {
                                if (element != "Green") {

                                    ids[index].css("background-color", "Orange");
                                    message += elementsNames[index] + " is blank.\n";
                                }
                                else
                                {
                                    ids[index].css("background-color", "White");
                                }
                                if (index + 1 == data.length) 
                                {
                                    alert(message += "\n Saving not possible. Correct all errors in order to save.");
                                }

                            });
                        }
                        else
                        {
                            $.ajax({
                                url: "/Employee/SSaveEmployeeDetails",
                                type: "POST",
                                data: { empData: employeeData },
                                success: function (response) {
                                    if (response.isValid) {
                                        location.reload();
                                    }
                                }
                            });
                        }
                    }
                });
            });
        });
    </script>
}